var $_=function(){"use strict";function t(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function n(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function e(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,n){return(o=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function i(t,n){return!n||"object"!=typeof n&&"function"!=typeof n?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):n}function u(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,o=r(t);if(n){var u=r(this).constructor;e=Reflect.construct(o,arguments,u)}else e=o.apply(this,arguments);return i(this,e)}}function c(t){return function(t){if(Array.isArray(t))return f(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return f(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);"Object"===e&&t.constructor&&(e=t.constructor.name);if("Map"===e||"Set"===e)return Array.from(t);if("Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e))return f(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var a=function(t){return new h(t).update()},s=function(t){var n=new p(void 0);return a((function(){return n._set(t())})),n},l=function(t){return t instanceof p?t:new p(t)},h=function(){function n(e){t(this,n),this.fn=e,this.deps=[]}return e(n,[{key:"update",value:function(){var t=this;this.deps.splice(0,this.deps.length).forEach((function(n){n._syncs.splice(n._syncs.indexOf(t),1)})),n.stack.unshift(this.deps),this.fn(),n.stack.shift().forEach((function(n){return n._syncs.push(t)}))}}]),n}();h.stack=[];var p=function(){function n(e){t(this,n),this._data=e,this._syncs=[]}return e(n,[{key:"get",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return t&&h.stack[0]&&!h.stack[0].includes(this)&&h.stack[0].push(this),this._data}},{key:"map",value:function(t){var n=this;return s((function(){return t(n.get())}))}},{key:"mapIf",value:function(t,n){var e=this;return t=l(t),s((function(){var r=e.get();return t.get()?n(r):r}))}},{key:"watch",value:function(t){var n=this;return a((function(){t(n.get())})),this}},{key:"_set",value:function(t){this._data=t,this._modified()}},{key:"_modified",value:function(){c(this._syncs).forEach((function(t){return t.update()}))}}]),n}(),y=function(n){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&o(t,n)}(i,n);var r=u(i);function i(n){return t(this,i),r.call(this,n)}return e(i,[{key:"set",value:function(t){this._set(t)}},{key:"modify",value:function(t){t(this._data),this._modified()}}]),i}(p),v=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!0===n?new p(t):new y(t)};return Object.assign(v,{ensure:l,calc:s,sync:a,getAll:function(t){return t.map((function(t){return t.get()}))},ensureAll:function(t){return t.map((function(t){return l(t)}))}}),v}();
